/* 
 * angular-disqus 1.0.2
 * http://github.com/kirstein/angular-disqus
 * 
 * Licensed under the MIT license
 */
!function(a,b){"use strict";var c=a.module("ngDisqus",[]);c.provider("$disqus",function(){function c(){return document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]}function d(){return k||b.disqus_shortname}function e(a){return"//"+a+".disqus.com/embed.js"}function f(a){var b=document.createElement("script");return b.type="text/javascript",b.async=!0,b.src=e(a),b}function g(a,b){var c,d,f=a.getElementsByTagName("script"),g=e(b);for(d=0;d<f.length;d+=1)if(c=f[d],~c.src.indexOf(g))return!0;return!1}function h(a,c,d,e){b.disqus_identifier=a,b.disqus_url=c,b.disqus_shortname=d,e&&(b.disqus_config=function(){this.page.remote_auth_s3=e.auth,this.page.api_key=e.publicKey})}function i(a,c){b.DISQUS.reset({reload:!0,config:function(){this.page.identifier=c,this.page.url=a.absUrl()}})}function j(a,b,e){var i=d(),j=c();g(j,i)||(h(b,a.absUrl(),i,e),j.appendChild(f(i)))}var k;this.setShortname=function(a){k=a},this.$get=["$location","$disqusSsoConfig",function(c,e){function f(f){if(!a.isDefined(d()))throw new Error("No disqus shortname defined");if(!a.isDefined(f))throw new Error("No disqus thread id defined");a.isDefined(b.DISQUS)?i(c,f):j(c,f,e.getCredentials())}return{commit:f,getShortname:d}}]}),c.directive("disqus",["$disqus",function(b){return{restrict:"AC",replace:!0,scope:{id:"=disqus"},template:'<div id="disqus_thread"></div>',link:function(c){c.$watch("id",function(c){a.isDefined(c)&&b.commit(c)})}}}]),c.service("$disqusSsoConfig",function(){var a=null;this.setCredentials=function(b,c){a={auth:b,publicKey:c}},this.getCredentials=function(){return a}})}(angular,this);
!function(a,b){"use strict";var c=a.module("ngDisqus",[]);c.provider("$disqus",function(){function c(){return document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]}function d(){return n||b.disqus_shortname}function e(){return language||b.disqus_language}function f(a,b){return"//"+a+".disqus.com/"+b}function g(a){var b=document.createElement("script");return b.type="text/javascript",b.async=!0,b.src=a,b}function h(a){var b=document.createElement("script");return b.type="text/javascript",b.async=!0,b.text=a,b}function i(a,b){var c,d,e=a.getElementsByTagName("script");for(d=0;d<e.length;d+=1)if(c=e[d],~c.src.indexOf(b))return!0;return!1}function j(c,d,e,f){b.disqus_identifier=c,b.disqus_url=d,b.disqus_shortname=e,a.isDefined(f)&&(b.disqus_language=f)}function k(){var c=b.DISQUSWIDGETS;c&&a.isFunction(c.getCount)&&c.getCount()}function l(c,d,e){b.DISQUS.reset({reload:!0,config:function(){console.log("reset!"),console.log(e),this.page.identifier=d,this.page.url=c.absUrl(),a.isDefined(e)&&(this.language=e)}})}function m(a,b){var d=c(),e=f(a,b);if(!i(d,e)){d.appendChild(g(e));var j=h("var disqus_config = function () {    this.language = window.language; };");d.appendChild(j)}}var n,o="embed.js",p="count.js";this.setShortname=function(a){n=a},this.setLanguage=function(a){a=a},this.$get=["$location","$routeParams",function(c,f){function g(e){var f=d();if(!a.isDefined(f))throw new Error("No disqus shortname defined");if(!a.isDefined(e))throw new Error("No disqus thread id defined");a.isDefined(b.DISQUS)?l(c,e,language):(j(e,c.absUrl(),f),a.isDefined(language)&&j(e,c.absUrl(),f,language),m(f,o))}function h(a){j(a,c.absUrl(),n,f.lang),m(d(),o),m(d(),p),k()}return{commit:g,getShortname:d,getLanguage:e,loadCount:h}}]}),c.directive("disqus",["$disqus",function(b){return{restrict:"AC",replace:!0,scope:{id:"=disqus",lang:"=language"},template:'<div id="disqus_thread"></div>',link:function(c){c.$watch("id",function(c){a.isDefined(c)&&b.commit(c)}),c.$watch("lang",function(d){a.isDefined(d)&&b.commit(c.id,d)})}}}]),c.directive("disqusIdentifier",["$disqus",function(a){return{restrict:"A",link:function(b,c,d){a.loadCount(d.disqusIdentifier)}}}])}(angular,this);
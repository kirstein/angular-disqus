/* 
 * angular-disqus 1.1.2
 * http://github.com/kirstein/angular-disqus
 * 
 * Licensed under the MIT license
 */
!function(a,b){"use strict";var c=a.module("ngDisqus",[]);c.provider("$disqus",function(){function c(){return document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]}function d(){return m||b.disqus_shortname}function e(){return b.disqus_sso||{}}function f(a,b){return"//"+a+".disqus.com/"+b}function g(a){var b=document.createElement("script");return b.type="text/javascript",b.async=!0,b.src=a,b}function h(a,b){var c,d,e=a.getElementsByTagName("script");for(d=0;d<e.length;d+=1)if(c=e[d],~c.src.indexOf(b))return!0;return!1}function i(a,c,d){b.disqus_identifier=c,b.disqus_url=a.absUrl(),b.disqus_shortname=m,b.disqus_title=d;var f=e();Object.keys(f).length>0&&(b.disqus_config=function(){this.page.remote_auth_s3=f.remote_auth_s3,this.page.api_key=f.api_key})}function j(){var c=b.DISQUSWIDGETS;c&&a.isFunction(c.getCount)&&c.getCount()}function k(a,c,d){var f=e();b.DISQUS.reset({reload:!0,config:function(){this.page.identifier=c,this.page.url=a.absUrl(),this.page.title=d,this.page.remote_auth_s3=f.remote_auth_s3,this.page.api_key=f.api_key}})}function l(a){var b=d(),e=c(),i=f(b,a);h(e,i)||e.appendChild(g(i))}var m,n="embed.js",o="count.js";this.setShortname=function(a){m=a},this.$get=["$location",function(c){function e(d,e){if(!a.isDefined(m))throw new Error("No disqus shortname defined");if(!a.isDefined(d))throw new Error("No disqus thread id defined");a.isDefined(b.DISQUS)?k(c,d,e):(i(c,d,e),l(n))}function f(d){b.disqus_sso=d,a.isDefined(b.DISQUS)&&k(c,b.disqus_identifier,b.disqus_title)}function g(a){i(c,a),l(n),l(o),j()}return{commit:e,getShortname:d,setSso:f,loadCount:g}}]}),c.service("disqusService",["$disqus",function(a){return{setSso:function(b){a.setSso(b)}}}]),c.directive("disqus",["$disqus",function(b){return{restrict:"AC",replace:!0,scope:{id:"=disqus",title:"=title"},template:'<div id="disqus_thread"></div>',link:function(c){c.$watch("id",function(d){a.isDefined(d)&&b.commit(d,c.title)})}}}]),c.directive("disqusIdentifier",["$disqus",function(a){return{restrict:"A",link:function(b,c,d){a.loadCount(d.disqusIdentifier)}}}])}(angular,this);